# 低代码数据计算

当底层数据完成集成后，数据依然是零散，价值密度低的，是无法直接为上层算法和DI应用提供数据服务的。这就需要对数据进行汇聚加工。

完成数据集成后，可以对FDP数据平台中的数据根据不同业务规则进行加工，从而发现其价值，主要步骤为数据清洗、数据萃取、数据导出，以下章节详细描述具体操作步骤。

## 数据清洗

### 离线数据清洗

1. 离线数据清洗任务配置时，任务节点所属工作流周期选择单次任务或周期任务。
2. 拖拽锚点可创建新的节点任务，选择数据清洗，进入参数填写页面。
3. 步骤一：对所要创建表类型，表名称，加载策略等基本信息进行填写，填写完毕后，点击下一步，进行步骤二和步骤三。
4. 步骤二/步骤三：对数据来源表（主模型）以及通过填写过滤条件对数据范围进行确定，在步骤三中可点击新增关联模型按钮，来选择与主模型关联的关联模型和关联方式，过滤条件对关联模型的数据范围进行筛选。配置完成后点击确认按钮，在列表中可查看、配置、删除已配置的关联模型。点击配置按钮，将主模型与关联模型关联条件进行设置。如果存在变更情况，需删除原配置关系，再进行重新配置新的关联关系。
5. 步骤四：完成关联模型配置后，点击下一步，配置目标模型字段。左侧同步模型字段列表中含主模型+关联模型所有字段，下侧填写过滤条件对主模型和关联模型的数据集，进行过滤。右侧目标模型字段可由左侧同步模型字段同步，亦可点击下侧添加按钮进行新建字段。确定目标模型所有字段后，点击右侧功能按钮，对字段描述、类型、计算逻辑等信息进行编辑。最后，点击上方SQL预览按钮，查看目标模型生成SQL逻辑，查看无误后，点击完成按钮，生成所创建的数据清洗节点。

![](https://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/08/20/004351ba-809f-4f46-8040-6ad66d6417e0.gif)

<table>
	<tr>
	    <th>步骤</th>
	    <th>参数</th>
	    <th>说明</th>  
      <th>是否必填</th> 
	</tr >
	<tr >
	    <td rowspan="12">步骤一</td>
	    <td>节点名称</td>
	    <td>任务节点名称</td>
    	<td>是</td>
	</tr>
	<tr>
	    <td>节点描述</td>
	    <td>任务节点描述</td>
    	<td>否</td>
	</tr>
	<tr>
	    <td>视图类型</td>
	    <td>选择视图编辑（可视化图形界面配置）/ 自定义编辑（文本代码编辑）</td>
    	<td>是</td>
	</tr>
	<tr>
	    <td>存储方式</td>
	    <td>选择存储一/存储二（存储一和存储二详见产品功能介绍）</td>
      <td>是</td>
	</tr>
	<tr>
      <td>清洗类型</td>
	    <td>选择事实表或维度表，详情请参考（数据模型设计与开发规范）</td>
      <td>是</td>
	</tr>
	<tr>
	    <td>创建方式</td>
	    <td>手动创建/选择已有（如将创建表为第一次创建，选择手动创建）</td>
      <td>是</td>
	</tr>
	<tr>
	    <td>表名称</td>
	    <td>维度表/事实表表名称</td>
      <td>是</td>
	</tr>
  <tr>
	    <td>表中文名</td>
	    <td>维度表/事实表表中文名称</td>
      <td>是</td>
	</tr>
  <tr>
	    <td>加载策略</td>
	    <td>增量/全量</td>
      <td>是</td>
	</tr>
  <tr>
	    <td>表描述</td>
	    <td>维度表/事实表表描述</td>
      <td>否</td>
	</tr>
  <tr>
	    <td>CPU</td>
	    <td>分配该任务节点使用CPU</td>
      <td>是</td>
	</tr>
  <tr>
	    <td>最大分配内存</td>
	    <td>分配该任务占用队列的最大内存</td>
      <td>是</td>
	</tr>
  <tr >
	    <td rowspan="2">步骤二</td>
	    <td>选择主模型</td>
	    <td>选择数据来源表</td>
    	<td>是</td>
	</tr>
  <tr>
	    <td>过滤条件</td>
	    <td>对数据来源表进行的过滤条件填写</td>
      <td>否</td>
	</tr>
  <tr >
	    <td rowspan="6">步骤三</td>
	    <td>选择关联模型</td>
	    <td>选择关联的数据表</td>
    	<td>是</td>
	</tr>
  <tr>
	    <td>关联类型</td>
	    <td>LEFT JOIN/RIGHT JOIN /FULL JOIN</td>
      <td>是</td>
	</tr>
  <tr>
	    <td>过滤条件</td>
	    <td>对数据来源表进行的过滤条件填写</td>
      <td>否</td>
	</tr>
  <tr>
	    <td>配置字段</td>
	    <td>主模型与关联模型关联条件</td>
      <td>是</td>
	</tr>
  <tr>
	    <td>配置方式</td>
	    <td>关联字段/自定义编辑</td>
      <td>是</td>
	</tr>
  <tr>
	    <td>关联字段</td>
	    <td>主模型关联字段</td>
      <td>是</td>
	</tr>
  <tr >
	    <td rowspan="9">步骤四</td>
	    <td>过滤条件</td>
	    <td>对主模型和关联模型的数据集，进行过滤</td>
    	<td>否</td>
	</tr>
  <tr>
	    <td>字段名</td>
	    <td>字段名称</td>
      <td>是</td>
	</tr>
  <tr>
	    <td>字段描述</td>
	    <td>字段描述</td>
      <td>否</td>
	</tr>
  <tr>
	    <td>字段类型</td>
	    <td>字段类型</td>
      <td>是</td>
	</tr>
  <tr>
	    <td>字段长度</td>
	    <td>字段长度</td>
      <td>否</td>
	</tr>
  <tr>
	    <td>是否主键</td>
	    <td>主键</td>
      <td>否</td>
	</tr>
  <tr>
	    <td>是否分区键</td>
	    <td>分区键</td>
      <td>否</td>
	</tr>
  <tr>
	    <td>配置方式</td>
	    <td>关联字段/自定义编辑（自定义逻辑选择自定义编辑）</td>
      <td>是</td>
	</tr>
  <tr>
	    <td>关联模型字段/配置规则</td>
	    <td>如配置方式选择关联字段，则在关联模型中选择相应字段，如在配置方式中选择自定义编辑，则在配置规则中编写规则</td>
      <td>是</td>
	</tr>
</table>


### 实时数据清洗

1. 实时数据清洗任务配置时，任务节点所属工作流周期选择实时任务。
2. 拖拽锚点可创建新的节点任务，选择数据清洗，目前实时数据清洗仅支持自定义编辑操作。
3. 填写实时清洗节点节点名称、CPU、表名称等基础信息。
4. 在自定义文本编辑中书写Flink-SQL逻辑，书写语法及参数配置可参考Flink官网。
5. 操作演示

![](https://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/08/20/73d5027b-8c64-40ed-9589-92dec067290d.gif)

## 数据萃取

### 离线数据萃取

1. 离线数据萃取任务配置时，任务节点所属工作流周期选择单次任务或周期任务。
2. 拖拽锚点可创建新的节点任务，选择数据萃取，进入参数填写页面。
3. 步骤一：对所要创建表类型，表名称，加载策略等基本信息进行填写，填写完毕后，点击下一步，进行步骤二和步骤三。
4. 步骤二/步骤三：对数据来源表（主模型）以及通过填写过滤条件对数据范围进行确定，在步骤三中可点击新增关联模型按钮，来选择与主模型关联的关联模型和关联方式，过滤条件对关联模型的数据范围进行筛选。配置完成后点击确认按钮，在列表中可查看、配置、删除已配置的关联模型。点击配置按钮，将主模型与关联模型关联条件进行设置。如果存在变更情况，需删除原配置关系，再进行重新配置新的关联关系。
5. 步骤四：完成关联模型配置后，点击下一步，配置目标模型字段。左侧同步模型字段列表中含主模型+关联模型所有字段，下侧填写过滤条件对主模型和关联模型的数据集，进行过滤。右侧目标模型字段可由左侧同步模型字段同步，亦可点击下侧添加按钮进行新建字段。确定目标模型所有字段后，点击右侧功能按钮，对字段描述、类型、计算逻辑等信息进行编辑。最后，点击上方 SQL 预览按钮，查看目标模型生成 SQL 逻辑，查看无误后，点击完成按钮，生成所创建的数据萃取节点。

![](https://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/08/20/98ee5f69-a331-4897-8c5d-ed27309ed3f6.gif)

<table>
	<tr>
	    <th>步骤</th>
	    <th>参数</th>
	    <th>说明</th>  
      <th>是否必填项</th>  
	</tr >
	<tr >
	    <td rowspan="12">步骤一</td>
	    <td>节点名称</td>
	    <td>任务节点名称</td>
    	<td>是</td>
	</tr>
	<tr>
	    <td>节点描述</td>
	    <td>任务节点描述</td>
      <td>否</td>
	</tr>
	<tr>
	    <td>视图类型</td>
	    <td>选择视图编辑（可视化图形界面配置）/ 自定义编辑（文本代码编辑）</td>
      <td>是</td>
	</tr>
	<tr>
	    <td>存储方式</td>
	    <td>选择存储一/存储二（存储一和存储二详见产品功能介绍）</td>
      <td>是</td>
	</tr>
	<tr>
      <td>萃取类型</td>
	    <td>选择汇总表或应用表，详情请参考（数据模型设计与开发规范）</td>
      <td>是</td>
	</tr>
	<tr>
	    <td>创建方式</td>
	    <td>手动创建/选择已有（如将创建表为第一次创建，选择手动创建）</td>
      <td>是</td>
	</tr>
	<tr>
	    <td>表名称</td>
	    <td>汇总表/应用表表名称</td>
      <td>是</td>
	</tr>
  <tr>
	    <td>表中文名</td>
	    <td>汇总表/应用表表中文名称</td>
      <td>是</td>
	</tr>
  <tr>
	    <td>加载策略</td>
	    <td>增量/全量</td>
      <td>是</td>
	</tr>
  <tr>
	    <td>表描述</td>
	    <td>汇总表/应用表表描述</td>
      <td>否</td>
	</tr>
  <tr>
	    <td>CPU</td>
	    <td>分配该任务节点使用CPU</td>
      <td>是</td>
	</tr>
  <tr>
	    <td>最大分配内存</td>
	    <td>分配该任务占用队列的最大内存</td>
      <td>是</td>
	</tr>
  <tr >
	    <td rowspan="1">步骤二</td>
	    <td>所有参数</td>
	    <td>同数据清洗步骤二一致，请参考数据数据清洗步骤二</td>
    	<td>参考步骤二</td>
	</tr>
  <tr >
	    <td rowspan="1">步骤三</td>
	    <td>所有参数</td>
	    <td>同数据清洗步骤三一致，请参考数据数据清洗步骤三</td>
    	<td>参考步骤三</td>
	</tr>
  <tr >
	    <td rowspan="1">步骤四</td>
	    <td>所有参数</td>
	    <td>同数据清洗步骤四一致，请参考数据数据清洗步骤四</td>
    	<td>参考步骤四</td>
	</tr>
</table>

### 实时数据萃取

1. 实时数据萃取任务配置时，任务节点所属工作流周期选择实时任务。
2. 拖拽锚点可创建新的节点任务，选择数据清洗，目前实时数据萃取仅支持自定义编辑操作。
3. 填写实时萃取节点节点名称、CPU、表名称等基础信息。
4. 在自定义文本编辑中书写Flink-SQL逻辑，书写语法及参数配置可参考Flink官网。

![](https://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/08/20/26731821-72c1-498c-bc57-8e5d51c6842a.gif)

## 数据导出

### 离线数据导出

1. 离线数据导出任务配置时，任务节点所属工作流周期选择单次任务或周期任务。
2. 拖拽锚点可创建新的节点任务，选择数据导出。
3. 填写数据导出节点基础信息。

| **参数**     | **说明**                                            | **是否必填项** |
| ------------ | --------------------------------------------------- | -------------- |
| 节点名称     | 任务节点名称                                        | 是             |
| 描述         | 任务节点描述                                        | 否             |
| 视图类型     | 选择视图编辑（目前仅支持视图导向配置）              | 是             |
| 存储方式     | 选择存储一/存储二（存储一和存储二详见产品功能介绍） | 是             |
| CPU          | 分配该任务节点使用CPU                               | 是             |
| 最大分配内存 | 分配该任务占用队列的最大内存                        | 是             |

4. 填写配置信息参数

   <table>
   	<tr>
   	    <th>模块</th>
   	    <th>参数</th>
   	    <th>说明</th>  
   	</tr >
   	<tr >
   	    <td rowspan="5">模型同步来源</td>
   	    <td>数据源</td>
   	    <td>默认数据平台存储组件</td>
   	</tr>
   	<tr>
   	    <td>数据模型</td>
   	    <td>选择已完成开发的数据模型</td>
   	</tr>
   	<tr>
   	    <td>加载策略</td>
   	    <td>全量/增量</td>
   	</tr>
   	<tr>
   	    <td>加载时间</td>
   	    <td>分/时/天（选择增量）</td>
   	</tr>
   	<tr><td>过滤条件</td>
   	    <td>对所要导出表进行数据范围确定</td>
   	</tr>
   	<tr >
   	    <td rowspan="4">模型同步目标</td>
   	    <td>数据源</td>
   	    <td>选择已配置完成的业务数据源</td>
   	</tr>
   	<tr>
   	    <td>数据模型</td>
   	    <td>选择已配置完成的业务源数据模型</td>
   	</tr>
   	<tr>
   	    <td>写入模式</td>
   	    <td>选择更新/覆盖</td>
   	</tr>
     <tr>
   	    <td>前置条件</td>
   	    <td>输入前置语句逻辑，如truncate table xxx</td>
   	</tr>
   </table>

5. 完成基础信息和配置信息参数填写后，可在左下角点击编辑按钮对每一个字段进行质量规则的配置，质量规则详情参考上述质量规则操作。
6. 最后点击确认按钮完成数据导出节点配置。

![](https://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/08/20/e0876f19-246f-4df6-b63b-b5cf00cb90b4.gif)

### 实时数据导出

实时任务配置时，任务节点所属工作流周期选择实时任务。

1. 拖拽锚点可创建新的节点任务，选择数据导出，目前实时数据导出仅支持自定义编辑操作。
2. 实时导出书写语法及参数配置可参考flink官网。

![](https://terminus-paas.oss-cn-hangzhou.aliyuncs.com/paas-doc/2021/08/20/9cb511cd-919d-482a-b5d4-41a9aa10f3bf.gif)

